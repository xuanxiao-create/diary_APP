<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç™»å½•å’Œé¡µé¢åŠ è½½æµ‹è¯•</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50">
    <div class="max-w-4xl mx-auto p-8">
        <h1 class="text-3xl font-bold mb-6">ç™»å½•å’Œé¡µé¢åŠ è½½æµ‹è¯•</h1>
        
        <div class="bg-white rounded-lg shadow p-6 mb-6">
            <h2 class="text-xl font-semibold mb-4">å½“å‰çŠ¶æ€</h2>
            <div id="current-status" class="space-y-2">
                <p class="text-gray-600">æ£€æŸ¥ä¸­...</p>
            </div>
        </div>
        
        <div class="bg-white rounded-lg shadow p-6 mb-6">
            <h2 class="text-xl font-semibold mb-4">å¿«é€Ÿæµ‹è¯•</h2>
            <div class="space-x-4">
                <button onclick="testLoginDemo()" class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700">
                    ç™»å½•demoç”¨æˆ·
                </button>
                <button onclick="testLoginAdmin()" class="px-4 py-2 bg-yellow-600 text-white rounded hover:bg-yellow-700">
                    ç™»å½•adminç”¨æˆ·
                </button>
                <button onclick="testPages()" class="px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700">
                    æµ‹è¯•æ‰€æœ‰é¡µé¢
                </button>
                <button onclick="logoutTest()" class="px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700">
                    é€€å‡ºç™»å½•
                </button>
            </div>
        </div>
        
        <div class="bg-white rounded-lg shadow p-6 mb-6">
            <h2 class="text-xl font-semibold mb-4">æµ‹è¯•ç»“æœ</h2>
            <div id="test-results" class="space-y-2">
                <p class="text-gray-600">ç­‰å¾…æµ‹è¯•...</p>
            </div>
        </div>
        
        <div class="bg-white rounded-lg shadow p-6 mb-6">
            <h2 class="text-xl font-semibold mb-4">é¡µé¢é“¾æ¥</h2>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <a href="index.html" class="block p-4 bg-indigo-50 hover:bg-indigo-100 rounded-lg text-center">
                    <div class="font-medium text-indigo-800">ä¸»é¡µé¢</div>
                </a>
                <button onclick="goTo('schedule')" class="block p-4 bg-green-50 hover:bg-green-100 rounded-lg text-center">
                    <div class="font-medium text-green-800">ä½œæ¯è¡¨</div>
                </button>
                <button onclick="goTo('categories')" class="block p-4 bg-purple-50 hover:bg-purple-100 rounded-lg text-center">
                    <div class="font-medium text-purple-800">åˆ†ç±»ç®¡ç†</div>
                </button>
                <button onclick="goTo('admin')" class="block p-4 bg-yellow-50 hover:bg-yellow-100 rounded-lg text-center">
                    <div class="font-medium text-yellow-800">ç®¡ç†å‘˜</div>
                </button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
    <script>
        // æ£€æŸ¥å½“å‰çŠ¶æ€
        function checkCurrentStatus() {
            const status = document.getElementById('current-status');
            const currentUser = JSON.parse(localStorage.getItem('currentUser') || 'null');
            
            if (currentUser) {
                status.innerHTML = `
                    <div class="text-green-600">âœ… å·²ç™»å½•: ${currentUser.username}</div>
                    <div class="text-blue-600">ğŸ“‹ è§’è‰²: ${currentUser.role || 'user'}</div>
                    <div class="text-gray-600">ğŸ†” ID: ${currentUser.id}</div>
                `;
            } else {
                status.innerHTML = `
                    <div class="text-red-600">âŒ æœªç™»å½•</div>
                    <div class="text-gray-600">è¯·ä½¿ç”¨æµ‹è¯•æŒ‰é’®ç™»å½•</div>
                `;
            }
        }
        
        // æµ‹è¯•ç™»å½•demoç”¨æˆ·
        function testLoginDemo() {
            const users = JSON.parse(localStorage.getItem('registeredUsers') || '[]');
            const demoUser = users.find(u => u.username === 'demo');
            
            if (demoUser) {
                currentUser = demoUser;
                localStorage.setItem('currentUser', JSON.stringify(demoUser));
                updateUserInterface();
                document.getElementById('test-results').innerHTML = 
                    '<div class="text-green-600">âœ… demoç”¨æˆ·ç™»å½•æˆåŠŸ</div>';
                checkCurrentStatus();
            } else {
                document.getElementById('test-results').innerHTML = 
                    '<div class="text-red-600">âŒ demoç”¨æˆ·ä¸å­˜åœ¨</div>';
            }
        }
        
        // æµ‹è¯•ç™»å½•adminç”¨æˆ·
        function testLoginAdmin() {
            const users = JSON.parse(localStorage.getItem('registeredUsers') || '[]');
            const adminUser = users.find(u => u.username === 'admin');
            
            if (adminUser) {
                currentUser = adminUser;
                localStorage.setItem('currentUser', JSON.stringify(adminUser));
                updateUserInterface();
                document.getElementById('test-results').innerHTML = 
                    '<div class="text-green-600">âœ… adminç”¨æˆ·ç™»å½•æˆåŠŸ</div>';
                checkCurrentStatus();
            } else {
                document.getElementById('test-results').innerHTML = 
                    '<div class="text-red-600">âŒ adminç”¨æˆ·ä¸å­˜åœ¨</div>';
            }
        }
        
        // æµ‹è¯•æ‰€æœ‰é¡µé¢
        function testPages() {
            if (!currentUser) {
                document.getElementById('test-results').innerHTML = 
                    '<div class="text-red-600">âŒ è¯·å…ˆç™»å½•</div>';
                return;
            }
            
            const pages = ['schedule', 'categories', 'admin'];
            let results = '<div class="space-y-1">';
            
            pages.forEach(page => {
                try {
                    goTo(page);
                    results += `<div class="text-green-600">âœ… ${page}é¡µé¢åŠ è½½æˆåŠŸ</div>`;
                } catch (error) {
                    results += `<div class="text-red-600">âŒ ${page}é¡µé¢åŠ è½½å¤±è´¥: ${error.message}</div>`;
                }
            });
            
            results += '</div>';
            document.getElementById('test-results').innerHTML = results;
        }
        
        // é€€å‡ºç™»å½•æµ‹è¯•
        function logoutTest() {
            currentUser = null;
            localStorage.removeItem('currentUser');
            updateUserInterface();
            document.getElementById('test-results').innerHTML = 
                '<div class="text-gray-600">â„¹ï¸ å·²é€€å‡ºç™»å½•</div>';
            checkCurrentStatus();
        }
        
        // åˆå§‹åŒ–
        setTimeout(checkCurrentStatus, 500);
    </script>
</body>
</html>